<!DOCTYPE html>
<html lang="en">
{% load static %}
{% include "header.html" %}

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stitch</title>
    <link rel="stylesheet" href="{% static 'css/compra_style.css' %}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>
        <script type="text/javascript">
            var user = '{{request.COOKIES.usuario}}'
            function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getCookie('csrftoken');
        </script>
</head>

<body>


    <div class="encabezado">

        <nav class="navegacionHome">
            <a href="/login/">HOMBRE</a>
            <a href="/login/">MUJER</a>
            <a href="/login/">NIÑO/a</a>
            <a href="/login/">SERVICIOS</a>
            <!-- si esta en register: hay que poner el enlace de login o quitar el siguiente enlace -->



            <!-- <div class="menu"> -->
                
            <button class="btn btn-dark dropdown-toggle dropdown" type="button" data-bs-toggle="dropdown" aria-expanded="true">
                ESTACIONES
            </button>
            <ul class="dropdown-menu ">
                {%for estacion in estaciones %}
                <li><a class="drop" href="/home/estaciones/{{estacion.nombre}}" id = "{{estacion.id}}">{{estacion.nombre}}</a></li>
                {%endfor%}
            </ul>
            <!-- <div class="icono-favoritos"> -->
            <a href="/mostrarFavoritos/" class="a-fav"><i class="fa-solid fa-heart favoritos"></i></a>

            <i class="fa-solid fa-cart-shopping cart-icon"></i>




            <button class="btn userButton" type="button" data-bs-toggle="dropdown" >
                <i class="fa-solid fa-user user"></i>
            </button>
            <ul class="dropdown-menu ">
                <li><a class="drop" href="/usuario/perfil">Perfil</a></li>

                
                {% if admin.rol %}
                <li><a class="drop" href="/adminController/">Admin</a></li>
                {%endif%}
                <li><a class="drop" href="#">Salir</a></li>
            </ul>


            


        </nav>
    </div>



<!--CONTENIDO del CARRITO-->
    <section class="section-productos">
        <!--PRODUCTO BOX-->
        <div class="productos-contenido">
            <form action="/comprar/" method="POST">
                {% csrf_token %}
                
            {% for prod in cesta %}
            <div class="producto-box">
                <img class="fotoProducto" src="{{prod.id_producto.foto.url}}" alt="fotoProducto"/>
                <input type="hidden" name="id_producto" value="{{prod.id_producto.id}}">
                    <h2 class="titulo-producto" id="titulo-producto">{{prod.nombre_producto}}</h2>
                    <input type="hidden" name="titulo_producto" value="{{prod.nombre_producto}}" >
                    <span class="precio-producto" >{{prod.precio_producto}}</span>€               
                    <a class="btn btn-danger" href="/eliminarProducto/{{prod.id_producto.id}}">Eliminar Producto</a>
                    <input type="number" value="1" name="cantidad">
                    <p class="descripcion-producto">{{prod.id_producto.descripcion}}</p>

                    <hr style="border : 3px solid">
                </div> 
         

            {%endfor%}
            
            <p>Precio Total: <span id="precio-total">0.00€</span></p>
            {%if cesta|length > 0 %}
            <a  href="/comprar/"><button type="sumbit" class="btn btn-success">Realizar Compra</button></a>
            {%else%}
            <a class="btn btn-success" href="/home/">Compra Algo</a>
            {%endif%}
            <input type="hidden" name="precio_total" id="precio-total-input">
        </form>
        
    

        </div>
        <p id="total" ></p>
    </section>


    <script src="{% static 'js/compra.js' %}" >


    </script>

</body>

</html>
{% include "footer.html" %}